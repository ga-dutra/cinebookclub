import*as e from"react";import{useMountEffect as n,useUnmountEffect as r}from"primereact/hooks";import{ObjectUtils as t}from"primereact/utils";function c(){return c=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e},c.apply(this,arguments)}var a=e.memo(e.forwardRef((function(o,i){var u=e.useRef(null),l=e.useRef(null),p=e.useRef(null),s=e.useRef(!1),d=function(){l.current=window.grecaptcha.render(u.current,{sitekey:o.siteKey,theme:o.theme,type:o.type,size:o.size,tabindex:o.tabIndex,hl:o.language,callback:h,"expired-callback":g})},f=function(){l.current&&window.grecaptcha.reset(l.current)},m=function(){return l.current?window.grecaptcha.getResponse(l.current):null},h=function(e){o.onResponse&&o.onResponse({response:e})},g=function(){o.onExpire&&o.onExpire()},w=function(){if(p.current=null,!window.grecaptcha){var e=document.head||document.getElementsByTagName("head")[0],n=document.createElement("script");n.src=o.sourceUrl,n.async=!0,n.defer=!0,n.onload=function(){window.grecaptcha?window.grecaptcha.ready((function(){d()})):console.warn("Recaptcha is not loaded")},p.current=n,e.appendChild(p.current)}};n((function(){s.current||(w(),window.grecaptcha&&d(),s.current=!0)})),r((function(){p.current&&p.current.parentNode&&p.current.parentNode.removeChild(p.current)})),e.useImperativeHandle(i,(function(){return{props:o,reset:f,getResponse:m,getElement:function(){return u.current}}}));var y=t.findDiffKeys(o,a.defaultProps);return e.createElement("div",c({ref:u,id:o.id},y))})));a.displayName="Captcha",a.defaultProps={__TYPE:"Captcha",id:null,language:"en",onExpire:null,onResponse:null,siteKey:null,size:"normal",sourceUrl:"https://www.google.com/recaptcha/api.js?render=explicit",tabIndex:0,theme:"light",type:"image"};export{a as Captcha};
